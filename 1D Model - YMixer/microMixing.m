function [time,varianceDissipation] = microMixing(s)

velocity=s.velocity;
R1= 5e-4; % m
R2= 8e-4; % m
R3= 18.7e-4; %m
v2=power(R1/R2,2)*velocity;
v3=power(R2/R3,2)*v2;

% this refers to Y-mixer described in Pwel's paper "Modeling of Mixing-Precipitation Processes: Agglomeration"
x_=[0	4.28E-05	8.78E-05	1.35E-04	1.85E-04	2.37E-04	2.92E-04	3.49E-04	4.10E-04	4.73E-04	5.40E-04	6.10E-04	6.84E-04	7.61E-04	8.43E-04	9.28E-04	1.02E-03	1.11E-03	1.21E-03	1.31E-03	1.42E-03	1.54E-03	1.66E-03	1.79E-03	1.92E-03	2.06E-03	2.21E-03	2.36E-03	2.52E-03	2.69E-03	2.87E-03	3.06E-03	3.26E-03	3.46E-03	3.68E-03	3.91E-03	4.15E-03	4.40E-03	4.67E-03	4.95E-03	5.24E-03	5.55E-03	5.87E-03	6.21E-03	6.57E-03	6.94E-03	7.33E-03	7.75E-03	8.18E-03	8.64E-03	9.12E-03	9.62E-03	1.02E-02	1.07E-02	1.13E-02	1.19E-02	1.25E-02	1.32E-02	1.39E-02	1.47E-02	1.55E-02	1.63E-02	1.72E-02	1.81E-02	1.90E-02	2.00E-02	2.11E-02	2.22E-02	2.33E-02	2.46E-02	2.59E-02	2.72E-02	2.86E-02	3.01E-02	3.17E-02	3.33E-02	3.50E-02	3.69E-02	3.88E-02	4.08E-02	4.29E-02	4.51E-02	4.74E-02	4.98E-02	5.24E-02	5.51E-02	5.79E-02	6.09E-02	6.40E-02	6.73E-02	7.07E-02	7.43E-02	7.81E-02	8.21E-02	8.63E-02	9.07E-02	9.53E-02	1.00E-01	1.05E-01	1.11E-01];
eps_=zeros(1,length(x_));
k_=[2.46E+01	3.21E+01	3.91E+01	4.51E+01	4.97E+01	5.36E+01	5.68E+01	6.03E+01	6.51E+01	7.17E+01	8.02E+01	8.97E+01	9.86E+01	1.08E+02	1.11E+02	1.11E+02	1.07E+02	1.00E+02	9.12E+01	8.25E+01	7.49E+01	6.91E+01	6.43E+01	6.02E+01	5.62E+01	5.20E+01	4.78E+01	4.33E+01	3.90E+01	3.48E+01	3.10E+01	2.77E+01	2.44E+01	2.13E+01	1.85E+01	1.60E+01	1.37E+01	1.18E+01	1.01E+01	8.61E+00	7.29E+00	6.23E+00	5.30E+00	4.52E+00	3.92E+00	3.42E+00	2.99E+00	2.64E+00	2.37E+00	2.13E+00	1.87E+00	1.64E+00	1.42E+00	1.24E+00	1.10E+00	9.96E-01	9.89E-01	1.00E+00	9.96E-01	9.64E-01	9.10E-01	8.36E-01	7.51E-01	6.63E-01	5.77E-01	4.97E-01	4.25E-01	3.62E-01	3.07E-01	2.60E-01	2.20E-01	1.87E-01	1.58E-01	1.35E-01	1.15E-01	9.85E-02	8.48E-02	7.31E-02	6.33E-02	5.50E-02	4.81E-02	4.23E-02	3.74E-02	3.32E-02	2.98E-02	2.68E-02	2.44E-02	2.23E-02	1.86E-02	1.71E-02	1.58E-02	1.48E-02	1.39E-02	1.32E-02	1.27E-02	1.22E-02	1.19E-02	1.16E-02	1.13E-02	1.11E-02];
time=zeros(1,length(x_));

for i=1:length(x_)
    if x_(i)>=0 && x_(i)<0.003
        time(i)=x_(i)./velocity;
    elseif x_(i)>=0.003 && x_(i)<0.0065
        r=R1+(x_(i)-3e-3)*(R2-R1)/3.5e-3;
        v=((R1/r)^2)*velocity;
        time(i)=x_(i)./velocity;
    elseif x_(i)>=0.0065 && x_(i)<0.0115
        r=R2+(x_(i)-6.5e-3)*(R2-R1)/5e-3;
        v=((R2/r)^2)*v2;
        time(i)=x_(i)./v2;
    else
        time(i)=x_(i)./v3;
    end
end

scaleTime=time(1);
time=time-scaleTime;

for i=1:length(time)
    eps_(i)=epsilon(time(i),s);
end

varianceDissipation=-s.Cphi./2.*eps_./k_;

end