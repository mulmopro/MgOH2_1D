function [epsilon_] = epsilon(time,s)

velocity=s.velocity;
R1= 5e-4; % m
R2= 8e-4; % m
R3= 18.7e-4; %m
v2=power(R1/R2,2)*s.velocity;
v3=power(R2/R3,2)*v2;

x_=[0	4.28E-05	8.78E-05	1.35E-04	1.85E-04	2.37E-04	2.92E-04	3.49E-04	4.10E-04	4.73E-04	5.40E-04	6.10E-04	6.84E-04	7.61E-04	8.43E-04	9.28E-04	1.02E-03	1.11E-03	1.21E-03	1.31E-03	1.42E-03	1.54E-03	1.66E-03	1.79E-03	1.92E-03	2.06E-03	2.21E-03	2.36E-03	2.52E-03	2.69E-03	2.87E-03	3.06E-03	3.26E-03	3.46E-03	3.68E-03	3.91E-03	4.15E-03	4.40E-03	4.67E-03	4.95E-03	5.24E-03	5.55E-03	5.87E-03	6.21E-03	6.57E-03	6.94E-03	7.33E-03	7.75E-03	8.18E-03	8.64E-03	9.12E-03	9.62E-03	1.02E-02	1.07E-02	1.13E-02	1.19E-02	1.25E-02	1.32E-02	1.39E-02	1.47E-02	1.55E-02	1.63E-02	1.72E-02	1.81E-02	1.90E-02	2.00E-02	2.11E-02	2.22E-02	2.33E-02	2.46E-02	2.59E-02	2.72E-02	2.86E-02	3.01E-02	3.17E-02	3.33E-02	3.50E-02	3.69E-02	3.88E-02	4.08E-02	4.29E-02	4.51E-02	4.74E-02	4.98E-02	5.24E-02	5.51E-02	5.79E-02	6.09E-02	6.40E-02	6.73E-02	7.07E-02	7.43E-02	7.81E-02	8.21E-02	8.63E-02	9.07E-02	9.53E-02	1.00E-01	1.05E-01	1.11E-01];
eps_=[3.08E+06	3.35E+06	3.53E+06	3.57E+06	3.47E+06	3.40E+06	3.37E+06	3.43E+06	3.61E+06	3.92E+06	4.36E+06	4.85E+06	5.22E+06	5.57E+06	5.43E+06	5.10E+06	4.51E+06	3.83E+06	3.17E+06	2.63E+06	2.22E+06	1.94E+06	1.72E+06	1.54E+06	1.36E+06	1.19E+06	1.03E+06	8.76E+05	7.36E+05	6.13E+05	5.07E+05	4.22E+05	3.37E+05	2.64E+05	2.05E+05	1.58E+05	1.21E+05	9.18E+04	6.97E+04	5.30E+04	4.07E+04	3.05E+04	2.30E+04	1.74E+04	1.30E+04	1.00E+04	7.68E+03	5.91E+03	4.65E+03	3.64E+03	2.77E+03	2.05E+03	1.50E+03	1.10E+03	8.35E+02	7.06E+02	6.40E+02	6.10E+02	5.79E+02	5.33E+02	4.76E+02	4.10E+02	3.43E+02	2.82E+02	2.27E+02	1.82E+02	1.44E+02	1.15E+02	9.15E+01	7.31E+01	5.90E+01	4.80E+01	3.95E+01	3.29E+01	2.79E+01	2.39E+01	2.08E+01	1.84E+01	1.64E+01	1.48E+01	1.35E+01	1.24E+01	8.19E+00	7.17E+00	6.23E+00	5.35E+00	4.51E+00	3.69E+00	2.31E+00	2.12E+00	1.96E+00	1.82E+00	1.69E+00	1.57E+00	2.03E+00	2.43E+00	2.12E+00	1.74E+00	1.30E+00	8.79E-01];
t_=zeros(1,length(x_));

for i=1:length(x_)
    if x_(i)>=0 && x_(i)<0.003
        t_(i)=x_(i)./velocity;
    elseif x_(i)>=0.003 && x_(i)<0.0065
        r=R1+(x_(i)-3e-3)*(R2-R1)/3.5e-3;
        v=((R1/r)^2)*velocity;
        t_(i)=x_(i)./velocity;
    elseif x_(i)>=0.0065 && x_(i)<0.0115
        r=R2+(x_(i)-6.5e-3)*(R2-R1)/5e-3;
        v=((R2/r)^2)*v2;
        t_(i)=x_(i)./v2;
    else
        t_(i)=x_(i)./v3;
    end
end
   
scaleTime=t_(1);
t_=t_-scaleTime;

epsilon_=interp1(t_,eps_,time);

end

